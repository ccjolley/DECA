---
title: "DECA index dump: Kenya"
date: "November 12, 2019"
output: html_document
---

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide'}
library(tidyverse)
library(vdem)
source('utils.R')
source('itu.R')
source('gsma.R')
source('fotn.R')
source('vdem.R')
source('wb.R')
source('wef-plots.R')
source('wjp.R')

cname <- 'Kenya'
```

## Access & Use

Mobile penetration: `r filter(itu,country==cname)$ind_mobile %>% round(1)`

Internet penetration: `r filter(itu,country==cname)$ind_internet %>% round(1)`

Affordability score: `r filter(gsma,country==cname)$mci_afford %>% round(1)` out of 100


## Censorship, information integrity and digital rights

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide'}
vdem_mesg <- function(cname,varname,interpret_tbl) {
  ordname <- paste0(varname,'_ord')
  vdem_priv <- extract_vdem(name_pattern=varname,include_ord=TRUE) %>%
    filter(vdem_country_name==cname) %>%
    arrange(desc(year)) %>%
    head(1) %>%
    rename(value=ordname)
  paste0(vdem_priv$value,' (',min(interpret_tbl$value),'-',max(interpret_tbl$value),' scale): ',
         filter(interpret_tbl,value==vdem_priv$value)$label)
}

privacy_rename <- tibble(
  value=0:4,
  label=c('The legal framework explicitly allows the government to access any type of personal data on the Internet.',
          'The legal framework explicitly allows the government to access most types of personal data on the Internet.',
          'The legal framework explicitly allows the government to access many types of personal data on the Internet.',
          'The legal framework explicitly allows the government to access only a few types of personal information on the Internet.',
          'The legal framework explicitly allows the government to access personal information on the Internet only in extraordinary circumstances.')
)

filcap_rename <- tibble(
  value=0:3,
  label=c('The government lacks any capacity to block access to any sites on the Internet.',
          'The government has limited capacity to block access to a few sites on the Internet.',
          'The government has adequate capacity to block access to most, but not all, specific sites on the Internet if it wanted to.',
          'The government has the capacity to block access to any sites on the Internet if it wanted to.')
)

filprc_rename <- tibble(
  value=0:4,
  label=c('Extremely often. It is a regular practice for the government to remove political content, except to sites that are pro-government.',
           'Often. The government commonly removes online political content, except sites that are pro-government.',
           'Sometimes. The government successfully removes about half of the critical online political content.',
           'Rarely. There have been only a few occasions on which the government removed political content.',
           'Never, or almost never. The government allows Internet access that is unrestricted.')
)
```

Freedom on the Net: `r filter(fotn,country==cname)$fotn_total` out of 100, higher is less free

Privacy law content: `r vdem_mesg(cname,'v2smprivcon',privacy_rename)`

Government filtering capacity: `r vdem_mesg(cname,'v2smgovfilcap',filcap_rename)`

Government filtering in practice: `r vdem_mesg(cname,'v2smgovfilprc',filprc_rename)`

## Digital Finance

Used mobile money in the past 12 months: `r (filter(wb,country==cname)$mm*100) %>% round(1)`%

Mobile money gender gap: Women are `r (filter(wb,country==cname)$mm_gender_gap*100) %>% round(1)` less likely to use MM than men.

## Digital trade and e-commerce

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide'}
firm_tech <- wef_private %>% 
  select(country,tech_abs) %>% 
  mutate(techrank=rank(desc(tech_abs))) %>% 
  na.omit
```

Starting a business score: `r filter(wb,country==cname)$db_startbiz %>% round(1)` out of 100

Trading across borders score: `r filter(wb,country==cname)$db_trade %>% round(1)` out of 100

Firm-level tech absorption rank: `r filter(firm_tech,country==cname)$techrank %>% round(1)` out of `r nrow(firm_tech)`

## Digital society and governance

```{r echo=FALSE, warning=FALSE, message=FALSE, results='hide'}
regcap_rename <- tibble(
  value=0:4,
  label=c('No, almost all online activity happens outside of reach of the state, where it lacks the capacity to remove illegal content.',
          'Not really. The state has extremely limited resources to regulate online content.',
          'Somewhat. The state has the capacity to regulate only some online content or some portions of the law.',
          'Mostly. The state has robust capacity to regulate online content, though not enough to regulate all content and all portions of the law.',
          'Yes, the government has sufficient capacity to regulate all online content.')
)

avgact_rename <- tibble(
  value=0:4,
  label=c('Never or almost never. Average people have almost never used social media to organize offline political action.',
          'Rarely. Average people do not typically use social media to organize offline political action.',
          'Sometimes. There are a few cases in which average people have used social media to organize offline political action.',
          'Often. There have been several cases in which average people have used social media to organize offline political action.',
          'Regularly. There are numerous cases in which average people have used social media to organize offline political action.')
)
```

Government capacity to regulate online content: `r vdem_mesg(cname,'v2smregcap',regcap_rename)`

Average peoples' use of social media to organize offline action `r vdem_mesg(cname,'v2smorgavgact',avgact_rename)`

WJP Fundamental Rights score: `r filter(wjp,country==cname)$fundamental_rights %>% round(2)` (0-1 scale)

## Infrastructure

Electricity access: `r filter(gsma,country==cname)$elect %>% round(1)`%

4G coverage: `r filter(gsma,country==cname)$cov_4G %>% round(1)`%

## TODO

FOTN classification into free, partly-free, etc.
Change template to use more precise wording around MM accounts
Add % sign to MM gender gap in Rmd
Add open government index
Add something else in place of electricity and telephone infrastructure (maybe an infra scatter plot)
add 2G-4G coverage